---
---
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex" />
    <!-- Decap config (közvetlenül a public-ból) -->
    <link href="/cockpit/config.yml" type="text/yaml" rel="cms-config-url" />
    <title>Arcanex Cockpit</title>
  </head>
  <body>
    <!-- 1) Netlify Identity (NPM-ből, inline module-ként, hogy Vite bundelje) -->
    <script type="module">
      import netlifyIdentity from "netlify-identity-widget";

      // Elfogadjuk mindkét linkformát: "#invite_token=..." és "#/invite_token=..."
      const h = location.hash || "";
      const m = h.match(/invite_token=([^&]+)/);
      if (/#\/invite_token=/.test(h) && m) {
        // Normalizáljuk egyszer a hasht, hogy a widget felismerje
        location.replace("#invite_token=" + m[1]);
      }

      netlifyIdentity.on("init", (user) => {
        const hasInvite = (location.hash || "").includes("invite_token");
        // Ha meghívó van és még nincs user: közvetlenül a "Sign up" (jelszó beállítás) fülre nyitunk
        if (!user && hasInvite) netlifyIdentity.open("signup");
      });
      netlifyIdentity.on("login", () => location.reload());
      netlifyIdentity.init();
    </script>

    <!-- 2) Decap CMS UI (CDN, stabil, 3.8.3) -->
    <script src="https://unpkg.com/decap-cms@3.8.3/dist/decap-cms.js"></script>
  </body>
</html>